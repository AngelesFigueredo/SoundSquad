<link rel="stylesheet" href="/stylesheets/profile.css" />

{{#with user}}

<div class="profile-header"></div>
<img class="profile-image" src="{{this.profileImg}}" alt="user's profile pic">

<div class="profile-body">
  <div class="row">
    <div class="col">
      <h2 class="profile-name">{{this.name}} {{this.lastName}}</h2>
      <h3 class="profile-username">@{{this.username}}</h3>
      <h4 class="profile-bio">{{this.description}}</h4>
    </div>

    {{#if ../myProfile}}
      <div class="col">
        <a class="profile-link edit-profile-link" href="/edit/{{this._id}}">Edita tu perfil</a>
      </div>
    {{/if}} 
  </div> 

  {{#if ../myProfile}}
  <div class="row justify-content-around">
  <a class="col-auto mr-auto profile-link" href="/{{this._id}}/friends">Mis amistades</a>
  <a class="col-auto mr-auto profile-link" href="/my-playlists">Mis playlists</a>
  <a class="col-auto mr-auto profile-link" href="/user/events/{{this._id}}">Mis eventos</a>
  </div>
  <br>

{{else}}
  
  {{#if (ifEquals ../friendship "false")}}
    <form id="friend-request-form" action="/friend-requests/{{this._id}}" method="POST">
      <button class="profile-link" type="submit">Enviar petici√≥n de amistad</button>
    </form>
  {{else}}
    {{#if (ifEquals ../friendship "pendingOut")}}
      <p>Has enviado una solicitud de amistad a {{this.username}}</p>
    {{else}}
      {{#if (ifEquals ../friendship "true")}}
        <p class="profile-message">{{this.username}} es tu amigx</p>
        <form id="unfollow-form" action="/unfollow/{{this._id}}" method="POST">
          <button class="profile-link" type="submit">Cancelar amistad</button>
        </form>
        <br>
        <h3>Explorar</h3>
        <div class="row justify-content-around">
        <a class="col-auto mr-auto profile-link" href="/{{this._id}}/friends">Amistades de {{this.name}}</a>
        <a class="col-auto mr-auto profile-link" href="/playlists-list/{{this._id}}">Playlists de {{this.name}}</a></li>
        <a class="col-auto mr-auto profile-link" href="/user/events/{{this._id}}">Eventos de {{this.name}}</a></li>
        </div>

        <br>
      {{else}}
        {{#if (ifEquals ../friendship "pendingIn")}}
          <p>{{this.username}} te ha enviado una solicitud de amistad, ve a <a href="/notifications">notificaciones</a> para contestarla</p>
        {{/if}}
      {{/if}}
    {{/if}}
  {{/if}}
{{/if}}
{{/with}}

{{#if posts}}
    <h2>Mis publicaciones:</h2>
    {{#each posts}}
    <div class="row">
        {{>postPartial post=this user=currentUser}}
        <div class="col-2 dropleft">
              <button class="btn btn-secondary dropdown-toggle white-button" type="button" id="dropdownMenu2" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <img class="options-post-button" src="images/icons/More_options.svg">
              </button>
                <div class="dropdown-menu" aria-labelledby="dropdownMenu2">
                  <form action="posts/{{_id}}/home/delete" method="POST" id="delete-form">
                    <button class="dropdown-item" type="submit">Borrar post</button>
                  </form>
                </div>
        </div>
    </div>

<div class="comment-box">
          <div>
            <form action="/{{_id}}/comment" method="POST">
              <input class="comment-input" type="text" name="content" placeholder="Deja un comentario" />
            </div>
            <div>
              <button class="comment-submit" type="submit">
                <img src="images/icons/Tick.svg" alt="enviar" />
              </button>
            </div>
            </form>
          </div>

      <hr>
      <br>
    {{/each}}
  {{/if}}


</div>